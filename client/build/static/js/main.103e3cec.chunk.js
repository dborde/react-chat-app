(this["webpackJsonpreact-chat-app"]=this["webpackJsonpreact-chat-app"]||[]).push([[0],{53:function(e,t,a){e.exports=a(90)},58:function(e,t,a){},81:function(e,t){},89:function(e,t,a){},90:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(43),c=a.n(r),s=(a(58),a(44)),m=a(45),l=a(50),i=a(52),u=a(13),d=a(1),f=a(46),h=a.n(f),p=a(14),E=a(47),b=a(2),g=a(16),v=a.n(g),j=function(e){return o.a.createElement(o.a.Fragment,null,e.rooms.map((function(e,t){return"undefined"!==typeof e?o.a.createElement("option",{key:t},e):null})))},O=function(e){return o.a.createElement(o.a.Fragment,null,o.a.createElement("h3",{className:"list-title"},"Active Rooms"),o.a.createElement("ul",{className:"rooms"},e.rooms.map((function(t,a){return"undefined"!==typeof t?o.a.createElement("li",{className:"switch-room ".concat(e.currentRoom===t?"disabled":""),key:a},o.a.createElement("button",{disabled:e.currentRoom===t,onClick:function(){return e.switchRoom(t)}},t)):null}))))},S=v()("https://borde-react-chat-app.herokuapp.com/"),y=Object(d.f)((function(e){var t=Object(n.useState)([]),a=Object(b.a)(t,2),r=a[0],c=a[1],s=Object(n.useState)({room:"",username:""}),m=Object(b.a)(s,2),l=m[0],i=m[1];Object(n.useEffect)((function(){S.on("roomsList",(function(e){var t=e.rooms;c(t)}))}),[r]),Object(n.useEffect)((function(){return function(){return S.off("roomsList")}}),[]);var u=function(e){var t=e.target,a=t.name,n=t.value;i(Object(E.a)({},l,Object(p.a)({},a,n)))};return o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-xs"},o.a.createElement("form",{className:"centered-form__box"},o.a.createElement("h2",null,"Join"),o.a.createElement("input",{name:"username",placeholder:"Display name",autoComplete:"off",value:l.username,onChange:u}),o.a.createElement("input",{type:"text",list:"rooms",name:"room",placeholder:"Room",autoComplete:"off",value:l.room,onChange:u}),o.a.createElement("datalist",{id:"rooms"},o.a.createElement(j,{rooms:r})),o.a.createElement("button",{onClick:function(){var t=l.username,a=l.room;t&&a&&e.history.push("/chat/".concat(t,"/").concat(a))},type:"button"},"Join"))))})),N=a(28),w=a.n(N),_=function(){var e=document.querySelector("#messages"),t=document.querySelector("#messages div"),a=t.lastElementChild;if(null!==a){var n=getComputedStyle(a),o=parseInt(n.marginBottom),r=a.offsetHeight+o,c=e.offsetHeight;t.scrollHeight-r<=e.scrollTop+c&&(e.scrollTop=e.scrollHeight)}},C=o.a.createContext(),k=a(49),x=a.n(k),R=function(e){var t=e.count,a=void 0===t?1:t,n=e.height,r=void 0===n?"3rem":n;return o.a.createElement(x.a,{borderRadius:0,width:"100%",widthRandomness:0,color:"#d8d8d8",height:r,count:a})},A=function(){var e=Object(n.useContext)(C),t=e.handleSubmit,a=e.sendLocation,r=e.onInputUpdate,c=e.textInput,s=e.message,m=e.disabled;return o.a.createElement("div",{className:"compose",onSubmit:function(e){return t(e)}},o.a.createElement("form",{id:"message-form"},o.a.createElement("input",{name:"message",placeholder:"Type your message...",autoComplete:"off",value:s,onChange:r,ref:c}),o.a.createElement("div",{className:"btnWrap"},o.a.createElement("button",{disabled:m,type:"submit",className:"btn"},o.a.createElement("i",{className:"tooltip fab fa-telegram-plane",alt:"send message",title:"send message"},o.a.createElement("span",{className:"tooltiptext"},"Send Message"))),o.a.createElement("button",{disabled:m,id:"send-location",className:"btn",onClick:function(e){return a(e)}},o.a.createElement("i",{className:"tooltip far fa-compass",alt:"send location",title:"send location"},o.a.createElement("span",{className:"tooltiptext"},"Send Location"))))))},L=function(){var e=Object(n.useContext)(C).messages;return o.a.createElement("div",{id:"messages",className:"chat__messages"},o.a.createElement("div",null,e.map((function(e,t){return"undefined"!==typeof e.username?o.a.createElement("div",{key:t,className:"message"},o.a.createElement("p",null,o.a.createElement("span",{className:"message__name"},e.username),o.a.createElement("span",{className:"message__meta"},e.createdAt)),e.url?o.a.createElement("p",null,o.a.createElement("a",{href:e.url,target:"_blank",rel:"noopener noreferrer"},"My current location")):o.a.createElement("p",null,e.message)):null}))))},M=a(51),T=function(e,t){switch(t.type){case"SET_MESSAGES":return[].concat(Object(M.a)(e),[t.data]);default:return e}},D=function(e){var t=e.roomData,a=t.users,n=t.room;return o.a.createElement(o.a.Fragment,null,o.a.createElement("h2",{className:"room-title"},n),o.a.createElement("h3",{className:"list-title"},"Users"),o.a.createElement("ul",{className:"users"},a.map((function(e,t){return o.a.createElement("li",{key:t},e.username)}))))},B=function(){var e=Object(n.useContext)(C),t=e.isSideBarActive,a=e.rooms,r=e.switchRoom,c=e.roomData,s=e.toggleSideBar,m=Object(n.useState)(0),l=Object(b.a)(m,2),i=l[0],u=l[1],d=Object(n.useState)(0),f=Object(b.a)(d,2),h=f[0],p=f[1];return Object(n.useEffect)((function(){var e=document.getElementById("sidebar");return e.addEventListener("touchstart",(function(e){u(e.changedTouches[0].screenX)})),e.addEventListener("touchend",(function(e){p(e.changedTouches[0].screenX)})),function(){e.removeEventListener("touchstart",(function(e){u(e.changedTouches[0].screenX)})),e.removeEventListener("touchend",(function(e){p(e.changedTouches[0].screenX)}))}}),[]),Object(n.useEffect)((function(){h<i&&Math.abs(h-i)>70&&s()}),[h]),o.a.createElement(o.a.Fragment,null,o.a.createElement("i",{onClick:s,className:"mobile-menu fas fa-bars ".concat(t?"active":"")}),o.a.createElement("div",{id:"sidebar",className:"chat__sidebar ".concat(t?"active":""),style:{height:window.innerHeight}},o.a.createElement("div",{id:"sidebar-users"},o.a.createElement(D,{roomData:c})),o.a.createElement("div",{id:"sidebar-rooms"},o.a.createElement(O,{rooms:a,currentRoom:c.room,switchRoom:r}))))},H=v()("https://borde-react-chat-app.herokuapp.com/"),I=Object(d.f)((function(e){var t=o.a.useRef(),a=Object(n.useReducer)(T,[]),r=Object(b.a)(a,2),c=r[0],s=r[1],m=Object(n.useState)(!1),l=Object(b.a)(m,2),i=l[0],u=l[1],d=Object(n.useState)(!1),f=Object(b.a)(d,2),h=f[0],p=f[1],E=Object(n.useState)(!1),g=Object(b.a)(E,2),v=g[0],j=g[1],O=Object(n.useState)(""),S=Object(b.a)(O,2),y=S[0],N=S[1],k=Object(n.useState)([]),x=Object(b.a)(k,2),M=x[0],D=x[1],I=Object(n.useState)({room:"",users:[]}),F=Object(b.a)(I,2),G=F[0],J=F[1];Object(n.useEffect)((function(){var t={username:e.match.params.username,room:e.match.params.room};H.emit("join",t,(function(t){t&&(alert(t),e.history.push("/"))})),H.on("roomData",(function(e){var t=e.room,a=e.users;J({room:t,users:a})})),H.on("roomsList",(function(e){var t=e.rooms;D(t)}))}),[e.match.params.username,e.match.params.room,e.history]),Object(n.useEffect)((function(){H.on("message",(function(e){var a={username:e.username,message:e.text,createdAt:w()(e.createdAt).format("h:mm a")};(null===t||void 0===t?void 0:t.current)&&t.current.focus(),s({type:"SET_MESSAGES",data:a}),_()})),H.on("locationMessage",(function(e){var t={username:e.username,url:e.url,createdAt:w()(e.createdAt).format("h:mm a")};s({type:"SET_MESSAGES",data:t}),_()}))}),[]);return o.a.createElement(C.Provider,{value:{disabled:i,handleSubmit:function(e){e.preventDefault(),u(!0),H.emit("sendMessage",y,(function(e){if(u(!1),N(""),e)return console.log(e)}))},isSideBarActive:v,onInputUpdate:function(e){N(e.target.value)},message:y,messages:c,roomData:G,rooms:M,sendLocation:function(e){if(e.preventDefault(),!navigator.geolocation)return alert("Geolocation is not supported by your browser.");u(!0),p(!0),navigator.geolocation.getCurrentPosition((function(e){H.emit("sendLocation",{lat:e.coords.latitude,long:e.coords.longitude},(function(){u(!1),p(!1)}))}))},switchRoom:function(t){var a=e.match.params.username;H.emit("switchRoom",a,t),e.history.push("/chat/".concat(a,"/").concat(t))},textInput:t,toggleSideBar:function(){j(!v)}}},o.a.createElement("div",{className:"chat",style:{height:window.innerHeight}},o.a.createElement(B,null),o.a.createElement("div",{className:"chat__main ".concat(v?"active":""),style:{height:document.documentElement.clientHeight}},h&&o.a.createElement(R,{height:"".concat(window.innerHeight,"px")}),o.a.createElement(L,null),o.a.createElement(A,null))))})),F=(a(89),function(e){Object(i.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={site_loaded:!1},n}return Object(m.a)(a,[{key:"componentDidMount",value:function(){this.setState({site_loaded:!0})}},{key:"render",value:function(){return o.a.createElement("div",{className:h()({App:!0,site_loaded:this.state.site_loaded})},o.a.createElement(u.a,null,o.a.createElement(d.c,null,o.a.createElement(d.a,{path:"/chat/:username/:room",component:I}),o.a.createElement(d.a,{path:"/",component:y}))))}}]),a}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(F,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[53,1,2]]]);
//# sourceMappingURL=main.103e3cec.chunk.js.map